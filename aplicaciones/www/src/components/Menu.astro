---
import datos from '@/datosVisibles/indicadores';
---

<nav id="menu">
  <ol>
    {
      datos.yas.map((ya) => {
        return (
          <li class="ya">
            <p class="nombreYa">{ya.nombre}</p>
            <ul class="indicadores">
              {ya.indicadores.map((indicador) => {
                return (
                  <li class="indicador" data-archivo={indicador.archivo}>
                    <a>{indicador.nombre}</a>
                  </li>
                );
              })}
            </ul>
          </li>
        );
      })
    }
  </ol>
</nav>

<script>
  import { cargarDatos } from '@/utilidades/cerebro';
  const yas = document.querySelectorAll<HTMLElement>('.ya');
  const indicadores = document.querySelectorAll<HTMLLIElement>('.indicador');

  // Enviar al cerebro el nombre del archivo de datos correspondiente al indicador
  indicadores.forEach((elemento) => {
    elemento.onclick = () => {
      cargarDatos(elemento.dataset.archivo);
    };
  });
  // Abrir sub menÃº de indicadores al hacer click en un 'ya'
  yas.forEach((contenedorYa) => {
    const nombreYa = contenedorYa.querySelector<HTMLElement>('.nombreYa');
    nombreYa.addEventListener('click', () => {
      abrirYa(contenedorYa);
    });
  });

  function abrirYa(contenedorYa: HTMLElement) {
    const contenedor = contenedorYa.querySelector<HTMLElement>('.indicadores');
    contenedor.classList.toggle('abierto');
  }
</script>

<style lang="scss">
  #menu {
    width: 40vw;
    padding-right: 1em;
    .ya {
      font-weight: 700;
      cursor: pointer;
    }
    .indicadores {
      font-weight: 300;
      display: none;
      list-style: disc;

      &.abierto {
        display: block;
      }
    }
  }
</style>
