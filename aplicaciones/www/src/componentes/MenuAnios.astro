<nav id="menuAños">
  <span id="añoElegido"> </span>
  <ul id="añosOcultos"></ul>
</nav>

<script>
  import { listaAños, añoSeleccionado } from '@/utilidades/cerebro';

  const menuAños = document.getElementById('menuAños') as HTMLElement;
  const añoElegido = document.getElementById('añoElegido');
  const añosOcultos = document.getElementById('añosOcultos');
  let añoActivo: HTMLSpanElement;

  listaAños.subscribe((lista) => {
    if (!lista.length) return;
    añosOcultos.innerHTML = '';
    menuAños.style.display = 'flex';

    lista.forEach(({ año, conDatos }, i) => {
      const boton = document.createElement('span');
      boton.className = 'botonAño';
      boton.innerText = año;

      // Si no hay datos en ese año, le agrega la clase 'vacio'
      if (!conDatos) {
        boton.classList.add('vacio');
      } else {
        boton.onclick = () => {
          if (añoActivo) {
            añoActivo.classList.remove('activo');
          }

          boton.classList.add('activo');
          añoActivo = boton;
          añoElegido.innerText = `${añoActivo.innerText} ▾`;
          añoSeleccionado.set(añoActivo.innerText);
        };

        if (i === lista.length - 1) {
          boton.click();
        }
      }
      añosOcultos.appendChild(boton);
    });
  });

  // Mostrar menu de años
  añoElegido.addEventListener('click', () => {
    añosOcultos.classList.toggle('abierto');
  });
</script>

<style lang="scss">
  #menuAños {
    display: flex;
    flex-direction: column;
    position: relative;
    width: 90px;
    cursor: pointer;
    display: none;
    text-align: center;
    font-size: 0.9em;
    width: fit-content;
    color: var(--moradoProfundo);
    margin: 1em;

    #añoElegido {
      border: 1px solid var(--moradoProfundo);
      padding: 0.2em 0.5em;
      border-radius: 5px;
    }

    #añosOcultos {
      display: none;
      position: absolute;
      top: 2em;
      width: 100%;
      z-index: 2;
      background-color: var(--blancoMarfil);

      &.abierto {
        display: flex;
        flex-direction: column;
      }
    }

    .botonAño {
      margin-right: 0.3em;
      border: 1px solid;
      cursor: pointer;
      padding: 0.2em;
      transition: all 0.25s ease-in-out;

      &:hover {
        background-color: antiquewhite;
      }

      &.activo {
        background-color: antiquewhite;
      }

      &.vacio {
        background-color: #969696;
        color: antiquewhite;
        pointer-events: none;
      }
    }
  }
</style>
